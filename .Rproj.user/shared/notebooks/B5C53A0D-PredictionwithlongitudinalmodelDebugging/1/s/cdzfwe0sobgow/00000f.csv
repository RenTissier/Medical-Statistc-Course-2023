"0",""
"0","data_abdomen$SCAN_PRIOR_DATE <- as.Date(data_abdomen$SCAN_PRIOR_DATE, format = '%d/%m/%Y')"
"0","data_abdomen$SCAN_SUBSQ_DATE <- as.Date(data_abdomen$SCAN_SUBSQ_DATE, format = '%d/%m/%Y')"
"0","data.radiol.filt <- NULL"
"0","t.prior <- NULL"
"0","t.subsq <- NULL"
"0","for (k in patients.common){"
"0","  data.radiology <- data_abdomen[data_abdomen$VK_PATIENTNR==k,]"
"0","  data.qol.patient <- data.qol[data.qol$id==k,]"
"0","  for (n in 1:length(data.radiology[,1])){"
"0","    dist.prior <- as.numeric(data.radiology$SCAN_PRIOR_DATE[n]) - as.numeric(data.qol.patient$prior)"
"0","    dist.subsq <- as.numeric(data.radiology$SCAN_SUBSQ_DATE[n]) - as.numeric(data.qol.patient$subs)"
"0","    if (min(abs(dist.prior))<= 42 & min(abs(dist.subsq))<= 42){"
"0","      data.radiol.filt <- rbind(data.radiol.filt,data.radiology[n,])"
"0","      t.prior <- c(t.prior, data.qol.patient$t.prior[which.min(abs(dist.prior))])"
"0","      t.subsq <- c(t.subsq, data.qol.patient$t.subs[which.min(abs(dist.subsq))])"
"0","    }"
"0","  }"
"0","}"
"0","data.radiology <- cbind(data.radiol.filt,t.prior, t.subsq)"
"0",""
"0","data.feature <- data.radiology[,c('VK_PATIENTNR','t.prior','SCAN_PRIOR_DATE','t.subsq','SCAN_SUBSQ_DATE',names( data.radiology )[grepl( ""feature"" , names( data.radiology ) )])]"
"0",""
"0",""
"0","data.patient.strange <- data.feature[data.feature$t.prior >= data.feature$t.subsq,]"
"0","strange.patient <- unique(data.patient.strange$VK_PATIENTNR)"
"0",""
"0","data.feature.filt <- data.feature[-which(data.feature$t.prior>= data.feature$t.subsq),]"
"0","data.feature.filt$time <- paste0(data.feature.filt$t.prior,data.feature.filt$t.subsq)"
